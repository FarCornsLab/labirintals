# Клиент-сервер API

## Базовый синтаксис команды
    {
        "cmd": "get_server_list",
        "params": {

        }
    }
* `cmd` 
    
    Команда серверу, описание команд и их параметры см. ниже.
*  `params`

    Обьект с параметрами команды, см. описание команд.
   
## Базовые модели данных

### PlayerModel: 
    для клиента обпязательно поле name
    {
        "name": String,
        "cid" : String,
        "oid" : String,
        "step_id": Int,
        "step_type": Enum(up, down, left, right),
        "position": {
            "up_border": Boolean,  (сверху есть препятстивие?)
            "right_border": Boolean,
            "down_border" : Boolean,
            "left_border" : Boolean
        }
    }
    
### ErrorModel
    {
        "code" : Int,
        "message" : String
    }

## Команды управления игрой

### Начало игры
*   `connection` - присоединение к игре.  
    От: `client`.  
    Параметры:  
    * `user_name` - имя пользователя.
    Ответ: `connection_answer`.
*   `connection_answer` - присоединение к игре.  
    От: `server`.  
    Параметры:  
    * `is_successfully`:
        * `true` в случае успешного соединения;
        * `false` - иначе. (будет показана ошибка)
    * `player`- PlayerModel (если нет ошибки)
    * `error` - ErrorModel
*   `get_game_params` - запрашивает параметры игры. 
    От: `client`.
    Ответ: `game_params`.
*   `game_params` - параметры игры.  
    От: `server`.  
    Параметры:  
    * `start_time` - время начала. В случае если равно 0 - оно ещё не известно.
    * `step_time` - время отведённое на 1 ход.
    * `players` - массив PlayerModel игроков.
     * `error` -  ErrorModel - ошибка (если есть)
    
### Процесс игры
*   `make_step` - уведомляет сервер о намерении сделать шаг. Также, способна изменить уже выбранны шаг при благоприятных условиях.  
    От: `client`.
    Параметры: 
    * `step_id` - номер шага. Отсчёт с 1. Если данное поле принимает значение:
        * 0  - игра не началась;
        * -1 - игра завершилась.
    * `step_type` - тип шага. Допустимые значения: `up`, `right`, `down`, `left`.
    Ответ: `step_answer`.
*   `step` - просит информацию о текущем шаге.  
    От: `client`.
    Ответ: `step_answer`.
*   `step_answer` - уведомляет игрока об последнем шаге. 
    От: `server`.  
    Параметры: 
    * `step_id` - номер текущего шага.
    * `set_step_type` - тип последнего успешно установленного шага. Может принимать значение (по мимо выше указанных) `null`.
    * `step_end_time` - время окончания хода.
    * `error` - ErrorModel - ошибка (если есть)
*   `get_position` - уведомляет игрока об последнем шаге. 
    От: `client`.  
    Ответ: 
*   `position` - возвращает позицию игрока.
    От: `server`.  
    Параметры: 
    * `step_id` - номер текущего шага. -1 в случае окончания игры.
    * `up_border` - показывает наличие препядствия сверху. Возможные згачения: `free` или `obstacle`.
    * `right_border` - показывает наличие препядствия справа. Возможные згачения: `free` или `obstacle`.
    * `down_border` - показывает наличие препядствия снизу. Возможные згачения: `free` или `obstacle`.
    * `left_border` - показывает наличие препядствия слева. Возможные згачения: `free` или `obstacle`.
